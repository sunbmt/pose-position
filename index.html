<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nh·∫≠n di·ªán ti·∫øng ·ªìn</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/sound"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/sound@0.8/dist/teachablemachine-sound.min.js"></script>
</head>
<body>
  <h2>üé§ Nh·∫≠n di·ªán ti·∫øng ·ªìn b·∫±ng Teachable Machine</h2>
  <button onclick="init()">B·∫≠t micro</button>
  <p id="status">Ch∆∞a kh·ªüi ƒë·ªông...</p>
  <p id="label"></p>
  <p id="confidence"></p>

  <script type="text/javascript">
    const URL = "https://teachablemachine.withgoogle.com/models/K9QZBfqg-/";
    let model, microphone;

    async function init() {
      document.getElementById("status").innerText = "ƒêang t·∫£i model...";
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      const soundModel = await tmSound.load(modelURL, metadataURL);
      microphone = await tmSound.createMicrophone();
      await microphone.open(); // s·∫Ω hi·ªán h·ªèi Allow mic

      document.getElementById("status").innerText = "Micro ƒë√£ b·∫≠t, ƒëang nh·∫≠n di·ªán...";
      window.requestAnimationFrame(loop);

      async function loop() {
        const prediction = await soundModel.predict(microphone);
        let best = prediction.reduce((a, b) => a.probability > b.probability ? a : b);
        document.getElementById("label").innerText = "Ph√°t hi·ªán: " + best.className;
        document.getElementById("confidence").innerText = "ƒê·ªô tin c·∫≠y: " + (best.probability * 100).toFixed(2) + "%";
        window.requestAnimationFrame(loop);
      }
    }
  </script>
</body>
</html>

